<ng-container *ngIf="isConnected else connectWallet">
  <ng-container [ngSwitch]="appearance">
    <ng-container *ngSwitchCase="'default'">
      <action-button (onClick)="onDisconnectWalletClick()"
                     color="red"
                     label="Disconnect Wallet">
      </action-button>
    </ng-container>

    <ng-container *ngSwitchCase="'icon'">
      <account-balance *ngIf="showBalance"
                       color="transparent"></account-balance>

      <recent-transactions-button
        #recentTXButton
        [style.display]="showTxButton && !(hasFailedTx || hasPendingTx) ? 'inline-flex' : 'none'">
      </recent-transactions-button>

      <action-button color="red"
                     label="1 failing"
                     rightIcon="wcl-icon-fail"
                     *ngIf="hasFailedTx && !hasPendingTx"
                     (onClick)="recentTXButton.onClick($event)">
      </action-button>

      <action-button color="white"
                     label="1 pending"
                     *ngIf="hasPendingTx"
                     [pending]="true"
                     (onClick)="recentTXButton.onClick($event)">
      </action-button>

      <ng-container *ngTemplateOutlet="networkOptionsDropdown"></ng-container>

      <account-popover [account]="{ address: accountAddress, name: accountName, icon: accountIcon }"
                       [options]="accountOptions"
                       (changeWalletProvider)="onChangeWalletClick()"
                       (disconnect)="onDisconnectWalletClick()"
                       (optionClick)="onAccountOptionClick($event)">
      </account-popover>
    </ng-container>

    <ng-container *ngSwitchCase="'button'">
      <ng-container *ngTemplateOutlet="networkOptionsDropdown"></ng-container>

      <div [class.wcl-account-button--translucent]="showBalance"
           class="wcl-account-button">
        <span *ngIf="showBalance"
              class="wcl-account-button__balance">{{ balance$ | async }} ETH</span>

        <action-button *ngIf="!(hasFailedTx || hasPendingTx)"
                       [label]="accountAddress | shortAddress"
                       (onClick)="onAccountClick()"
                       [identicon]="identicon"
                       color="white">
        </action-button>

        <action-button color="red"
                       label="1 failing"
                       rightIcon="wcl-icon-fail"
                       *ngIf="hasFailedTx && !hasPendingTx"
                       (onClick)="onAccountClick()">
        </action-button>

        <action-button color="white"
                       label="1 pending"
                       *ngIf="hasPendingTx"
                       [pending]="true"
                       (onClick)="onAccountClick()">
        </action-button>
      </div>
    </ng-container>
  </ng-container>
</ng-container>

<ng-template #connectWallet>
  <action-button [leftIcon]="withIcon ? 'wcl-icon-wallet' : ''"
                 [disabled]="disabled"
                 [fullWidth]="fullWidth"
                 (onClick)="onConnectWalletClick()"
                 label="Connect Wallet"
                 color="blue">
  </action-button>
</ng-template>

<ng-template #networkOptionsDropdown>
  <network-dropdown *ngIf="showNetworkOptions"
                    [options]="networkOptions"
                    [wrongNetwork]="wrongNetwork$ | async"
                    (onChange)="onNetworkChange($event)">
  </network-dropdown>
</ng-template>
